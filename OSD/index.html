<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OS Downloader</title>
    <style>
        html, body {
            height: 100%;
        }
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            margin: 0;
            padding: 0;
            text-align: center;
            background: linear-gradient(135deg, #1a2a6c, #b21f1f, #fdbb2d) no-repeat;
            color: #ffffff;
        }
        header {
            background-color: rgba(0, 0, 0, 0.7);
            backdrop-filter: blur(10px);
            padding: 1.5rem 0;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        h1 {
            margin: 0;
            font-size: 2.5rem;
            font-weight: 700;
        }
        .container {
            margin-top: 2rem;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            padding: 30px;
            max-width: 500px;
            margin-left: auto;
            margin-right: auto;
            box-shadow: 0 8px 15px rgba(0, 0, 0, 0.2);
        }
        select, button {
            display: block;
            width: 100%;
            margin: 10px 0;
            padding: 12px;
            font-size: 1rem;
            border: none;
            border-radius: 10px;
            background-color: rgba(255, 255, 255, 0.2);
            color: #ffffff;
            transition: all 0.3s ease;
        }
        select:focus, button:focus {
            outline: none;
            border: 1px solid rgba(255, 255, 255, 0.8);
            box-shadow: 0 0 0 4px rgba(255, 255, 255, 0.2);
        }
        select:hover, button:hover {
            background-color: rgba(255, 255, 255, 0.4);
        }
        label {
            font-size: 1rem;
            font-weight: 500;
        }
        #link-container a {
            text-decoration: none;
            color: white;
            background-color: #007aff;
            padding: 12px 20px;
            border-radius: 10px;
            display: inline-block;
            transition: background-color 0.3s;
        }
        #link-container a:hover {
            background-color: #0056d6;
        }
        .icon {
            pointer-events: none;
            width: 30px;
            height: 30px;
            vertical-align: middle;
            margin-right: 10px;
        }
    </style>
</head>
<body>
    <header>
        <h1>OS Downloader</h1>
    </header>
    <div class="container">
        <label for="os-select">
            <img class="icon" src="/favicon.ico" alt="OS Icon"> Choose an Operating System:
        </label><br>
        <select id="os-select">
            <option value="">-- Select OS --</option>
            <option value="macos">macOS</option>
            <option value="windows">Windows</option>
            <option value="linux">Linux</option>
        </select>
        <br>
        <div id="version-container" style="display: none;">
            <label for="version-select">Choose a Version:</label><br>
            <select id="version-select"></select>
        </div>
        <br>
        <div id="architecture-container" style="display: none;">
            <label for="architecture-select">Choose Architecture:</label><br>
            <select id="architecture-select"></select>
        </div>
        <br>
        <div id="subversion-container" style="display: none;">
            <label for="subversion-select">Choose Sub-Version:</label><br>
            <select id="subversion-select"></select>
        </div>
        <br>
        <div id="link-container" style="display: none;">
            <a id="download-link" href="#" target="_blank">Download</a>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
        osSelect.value = "";
        });
        const osSelect = document.getElementById('os-select');
        const versionContainer = document.getElementById('version-container');
        const versionSelect = document.getElementById('version-select');
        const architectureContainer = document.getElementById('architecture-container');
        const architectureSelect = document.getElementById('architecture-select');
        const subversionContainer = document.getElementById('subversion-container');
        const subversionSelect = document.getElementById('subversion-select');
        const linkContainer = document.getElementById('link-container');
        const downloadLink = document.getElementById('download-link');
    
        let osData = {};

        fetch('/OSD/OSLinks.json')
            .then(response => response.json())
            .then(data => {
                osData = data;
            })
            .catch(error => console.error('Error loading data:', error));
    
        osSelect.addEventListener('change', () => {
            resetContainers();
            const selectedOS = osSelect.value;
            if (selectedOS === "macos") {
                populateDropdown(versionSelect, osData.macos.versions);
                versionContainer.style.display = 'block';
                versionSelect.addEventListener('change', () => {
                    const selectedVersion = versionSelect.value;
                    if (selectedVersion) {
                        downloadLink.href = osData.macos.links[selectedVersion];
                        linkContainer.style.display = 'block';
                    }
                });
            }
            if (selectedOS === "linux") {
                populateDropdown(versionSelect, osData.linux.versions);
                 versionContainer.style.display = 'block';
                versionSelect.addEventListener('change', () => {
                    const selectedVersion = versionSelect.value;
                    if (selectedVersion) {
                        populateDropdown(architectureSelect, osData.linux.architectures[selectedVersion] || []);
                        architectureContainer.style.display = 'block';
                        architectureSelect.addEventListener('change', () => {
                            const selectedArch = architectureSelect.value;
                            if (selectedArch) {
                                downloadLink.href = osData.linux.links[selectedVersion][selectedArch];
                                linkContainer.style.display = 'block';
                            }
                        });
                    }
                });
            }
                else if (selectedOS === "windows") {
                    populateDropdown(versionSelect, osData.windows.versions);
                    versionContainer.style.display = 'block';
                    versionSelect.addEventListener('change', () => {
                        const selectedVersion = versionSelect.value;
                        if (selectedVersion) {
                            populateDropdown(architectureSelect, osData.windows.architectures[selectedVersion] || []);
                            architectureContainer.style.display = 'block';
                            architectureSelect.addEventListener('change', () => {
                                const selectedArch = architectureSelect.value;
                                if (selectedArch) {
                                    populateDropdown(subversionSelect, osData.windows.subversions[selectedVersion][selectedArch] || []);
                                    subversionContainer.style.display = 'block';
                                    subversionSelect.addEventListener('change', () => {
                                        const selectedSubversionIndex = subversionSelect.value;
                                        if (selectedSubversionIndex !== "") {
                                            downloadLink.href = osData.windows.links[selectedVersion][selectedArch][selectedSubversionIndex];
                                            linkContainer.style.display = 'block';
                                        } else {
                                            linkContainer.style.display = 'none';
                                        }
                                    });
                                }
                            });
                        }
                    });
                }
            });
    
        function populateDropdown(selectElement, options) {
            selectElement.innerHTML = "<option value=''>-- Select --</option>";
            if (Array.isArray(options) && options.length) {
                options.forEach((option) => {
                    const opt = document.createElement('option');
                    opt.value = option;
                    opt.textContent = option;
                    selectElement.appendChild(opt);
                });
            }
        }
    
        function resetContainers() {
            versionContainer.style.display = 'none';
            architectureContainer.style.display = 'none';
            subversionContainer.style.display = 'none';
            linkContainer.style.display = 'none';
        }
    </script>    
</body>
</html>
